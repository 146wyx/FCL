<Window x:Class="FunCraftLauncher.Views.DownloadOptionsDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="下载选项" 
        Height="500" 
        Width="550"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent">
    <Border Background="#FF2C2C2C" CornerRadius="8" BorderBrush="#FF3C3C3C" BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- 标题栏 -->
            <Border Grid.Row="0" Background="#FF3C3C3C" CornerRadius="8,8,0,0" Padding="20,15">
                <Grid>
                    <TextBlock x:Name="TitleText"
                               Text="下载 Minecraft"
                               Foreground="White"
                               FontSize="16"
                               FontWeight="SemiBold"
                               VerticalAlignment="Center"/>
                    <Button x:Name="CloseButton"
                            Width="28"
                            Height="28"
                            HorizontalAlignment="Right"
                            Background="Transparent"
                            Foreground="#FF888888"
                            FontSize="14"
                            Content="&#xE711;"
                            FontFamily="Segoe MDL2 Assets"
                            BorderThickness="0"
                            Click="CloseButton_Click">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="14">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#FFDC3545"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </Grid>
            </Border>

            <!-- 内容区 -->
            <Grid Grid.Row="1" Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- 版本信息 -->
                <Border Grid.Row="0" Background="#FF252525" CornerRadius="8" Padding="15" Margin="0,0,0,15">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Width="50" Height="50" Background="#FF4CAF50" CornerRadius="8" Margin="0,0,15,0">
                            <TextBlock Text="&#xE768;" 
                                       FontFamily="Segoe MDL2 Assets"
                                       Foreground="White"
                                       FontSize="24"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"/>
                        </Border>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock x:Name="VersionText"
                                       Text="1.21.11"
                                       Foreground="White"
                                       FontSize="18"
                                       FontWeight="SemiBold"/>
                            <TextBlock x:Name="TypeText"
                                       Text="正式版"
                                       Foreground="#FF888888"
                                       FontSize="13"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- 选择 Mod 加载器 -->
                <TextBlock Grid.Row="1" 
                           Text="选择 Mod 加载器（可选）：" 
                           Foreground="White"
                           FontSize="14"
                           FontWeight="SemiBold"
                           Margin="0,0,0,10"/>

                <!-- 加载器选项 -->
                <StackPanel Grid.Row="2" Margin="0,0,0,15">
                    <ComboBox x:Name="ModLoaderComboBox"
                              Height="40"
                              Background="#FF252525"
                              Foreground="White"
                              FontSize="13"
                              SelectionChanged="ModLoaderComboBox_SelectionChanged">
                        <ComboBox.Style>
                            <Style TargetType="ComboBox">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ComboBox">
                                            <Border Background="#FF252525" 
                                                    BorderBrush="#FF3C3C3C" 
                                                    BorderThickness="1" 
                                                    CornerRadius="6">
                                                <Grid>
                                                    <ToggleButton x:Name="ToggleButton"
                                                                  Background="Transparent"
                                                                  BorderThickness="0"
                                                                  ClickMode="Press"
                                                                  IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}">
                                                        <ToggleButton.Style>
                                                            <Style TargetType="ToggleButton">
                                                                <Setter Property="Template">
                                                                    <Setter.Value>
                                                                        <ControlTemplate TargetType="ToggleButton">
                                                                            <Border Background="Transparent" Padding="10,0">
                                                                                <Grid>
                                                                                    <Grid.ColumnDefinitions>
                                                                                        <ColumnDefinition Width="*"/>
                                                                                        <ColumnDefinition Width="30"/>
                                                                                    </Grid.ColumnDefinitions>
                                                                                    <ContentPresenter Grid.Column="0" 
                                                                                                      Content="{TemplateBinding Content}"
                                                                                                      VerticalAlignment="Center"
                                                                                                      HorizontalAlignment="Left"/>
                                                                                    <TextBlock Grid.Column="1" 
                                                                                               Text="&#xE70D;" 
                                                                                               FontFamily="Segoe MDL2 Assets"
                                                                                               Foreground="White"
                                                                                               VerticalAlignment="Center"
                                                                                               HorizontalAlignment="Center"/>
                                                                                </Grid>
                                                                            </Border>
                                                                        </ControlTemplate>
                                                                    </Setter.Value>
                                                                </Setter>
                                                            </Style>
                                                        </ToggleButton.Style>
                                                    </ToggleButton>
                                                    <Popup x:Name="Popup"
                                                           Placement="Bottom"
                                                           IsOpen="{TemplateBinding IsDropDownOpen}"
                                                           AllowsTransparency="True"
                                                           PopupAnimation="Slide">
                                                        <Border Background="#FF2C2C2C" 
                                                                BorderBrush="#FF3C3C3C" 
                                                                BorderThickness="1" 
                                                                CornerRadius="6"
                                                                Padding="5">
                                                            <ScrollViewer>
                                                                <ItemsPresenter/>
                                                            </ScrollViewer>
                                                        </Border>
                                                    </Popup>
                                                </Grid>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="BorderBrush" Value="#FF0078D4"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </ComboBox.Style>
                        <ComboBoxItem Content="不安装 Mod 加载器" Tag="none" IsSelected="True">
                            <ComboBoxItem.Style>
                                <Style TargetType="ComboBoxItem">
                                    <Setter Property="Background" Value="#FF2C2C2C"/>
                                    <Setter Property="Foreground" Value="White"/>
                                    <Setter Property="Padding" Value="10,8"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#FF3C3C3C"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#FF0078D4"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </ComboBoxItem.Style>
                        </ComboBoxItem>
                        <ComboBoxItem Content="Forge - 最流行的 Mod 加载器" Tag="forge">
                            <ComboBoxItem.Style>
                                <Style TargetType="ComboBoxItem">
                                    <Setter Property="Background" Value="#FF2C2C2C"/>
                                    <Setter Property="Foreground" Value="White"/>
                                    <Setter Property="Padding" Value="10,8"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#FF3C3C3C"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#FF0078D4"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </ComboBoxItem.Style>
                        </ComboBoxItem>
                        <ComboBoxItem Content="NeoForge - Forge 的分支，支持 1.20.1+" Tag="neoforge">
                            <ComboBoxItem.Style>
                                <Style TargetType="ComboBoxItem">
                                    <Setter Property="Background" Value="#FF2C2C2C"/>
                                    <Setter Property="Foreground" Value="White"/>
                                    <Setter Property="Padding" Value="10,8"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#FF3C3C3C"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#FF0078D4"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </ComboBoxItem.Style>
                        </ComboBoxItem>
                        <ComboBoxItem Content="Fabric - 轻量级 Mod 加载器" Tag="fabric">
                            <ComboBoxItem.Style>
                                <Style TargetType="ComboBoxItem">
                                    <Setter Property="Background" Value="#FF2C2C2C"/>
                                    <Setter Property="Foreground" Value="White"/>
                                    <Setter Property="Padding" Value="10,8"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#FF3C3C3C"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#FF0078D4"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </ComboBoxItem.Style>
                        </ComboBoxItem>
                        <ComboBoxItem Content="Quilt - Fabric 的分支" Tag="quilt">
                            <ComboBoxItem.Style>
                                <Style TargetType="ComboBoxItem">
                                    <Setter Property="Background" Value="#FF2C2C2C"/>
                                    <Setter Property="Foreground" Value="White"/>
                                    <Setter Property="Padding" Value="10,8"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#FF3C3C3C"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#FF0078D4"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </ComboBoxItem.Style>
                        </ComboBoxItem>
                    </ComboBox>
                </StackPanel>

                <!-- 版本选择 -->
                <Grid Grid.Row="3">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" 
                               x:Name="VersionSelectLabel"
                               Text="选择版本：" 
                               Foreground="White"
                               FontSize="14"
                               FontWeight="SemiBold"
                               Margin="0,0,0,10"
                               Visibility="Collapsed"/>

                    <!-- 加载中提示 -->
                    <Border x:Name="LoadingPanel"
                            Grid.Row="1"
                            Background="#FF252525"
                            CornerRadius="8"
                            Visibility="Collapsed">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Margin="20">
                            <TextBlock Text="&#xE768;" 
                                       FontFamily="Segoe MDL2 Assets"
                                       Foreground="#FF0078D4"
                                       FontSize="24"
                                       HorizontalAlignment="Center"
                                       Margin="0,0,0,10">
                                <TextBlock.RenderTransform>
                                    <RotateTransform Angle="0" CenterX="12" CenterY="12"/>
                                </TextBlock.RenderTransform>
                                <TextBlock.Triggers>
                                    <EventTrigger RoutedEvent="Loaded">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetProperty="(TextBlock.RenderTransform).(RotateTransform.Angle)"
                                                                 From="0" To="360" Duration="0:0:1" RepeatBehavior="Forever"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </TextBlock.Triggers>
                            </TextBlock>
                            <TextBlock Text="正在加载版本列表..." 
                                       Foreground="#FF888888" 
                                       FontSize="12"/>
                        </StackPanel>
                    </Border>

                    <!-- 版本列表 -->
                    <Border Grid.Row="1" 
                            Background="#FF252525" 
                            CornerRadius="8"
                            Padding="10">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="150">
                            <StackPanel x:Name="ModLoaderVersionPanel">
                                <!-- 动态生成的版本项 -->
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </Grid>

            <!-- 底部按钮 -->
            <Border Grid.Row="2" Background="#FF252525" CornerRadius="0,0,8,8" Padding="20">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button x:Name="CancelButton"
                            Height="36"
                            Width="80"
                            Margin="0,0,10,0"
                            Background="Transparent"
                            Foreground="#FF888888"
                            FontSize="13"
                            BorderThickness="1"
                            BorderBrush="#FF3C3C3C"
                            Content="取消"
                            Click="CancelButton_Click">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" 
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    CornerRadius="6">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#FF3C3C3C"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                    <Button x:Name="ConfirmButton"
                            Height="36"
                            Width="100"
                            Background="#FF0078D4"
                            Foreground="White"
                            FontSize="13"
                            BorderThickness="0"
                            Content="开始下载"
                            Click="ConfirmButton_Click">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" CornerRadius="6">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#FF106EBE"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
            </Border>
        </Grid>
    </Border>
</Window>
